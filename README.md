# malSTUN
Proof-of-concept code for data exfiltration / transfer using the STUN protocol. 

More details here: https://killthemalware.com/blog/2017/3/2/malstun-data-exfil-using-the-stun-protocol

##server.py
The server listens on a UDP port for STUN traffic generated by client.py. New paylods are written to disk, as and when file transfers are identified. 
```
usage: server.py [-h] -s SERVER -p PORT [-v]

malSTUN server.py - Data exfil via STUN protocol

optional arguments:
  -h, --help            show this help message and exit
  -s SERVER, --server SERVER
                        STUN Server Address
  -p PORT, --port PORT  STUN Server Port
  -v, --verbose         Enable verbose output
  ```

##client.py
The client chunks the specified input binary file, and transfers it to the specified remote STUN server. Each STUN packet contains 12 bytes of data; the delay between packet transmission is configurable. 

```
usage: client.py [-h] -s SERVER -p PORT -f FILE

malSTUN client.py - Data exfil via STUN protocol

optional arguments:
  -h, --help            show this help message and exit
  -s SERVER, --server SERVER
                        STUN Server Address
  -p PORT, --port PORT  STUN Server Port
  -f FILE, --file FILE  File to send
  ```
  
  NOTE: This is proof-of-concept code; use at your own risk.
